<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="5.0" version="22.1.0" etag="drawio" type="device">
  <diagram name="Deployment Workflow" id="deployment-workflow">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Kubernetes Platform Deployment Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- Start -->
        <mxCell id="start" value="START&#xa;Local Kubernetes Platform Deployment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="80" width="300" height="60" as="geometry" />
        </mxCell>

        <!-- Step 0: Prerequisites -->
        <mxCell id="step0" value="Step 0: Prerequisites Check&#xa;â€¢ kubectl installed?&#xa;â€¢ Helm installed?&#xa;â€¢ Kubernetes cluster running?" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;align=left" vertex="1" parent="1">
          <mxGeometry x="550" y="170" width="300" height="80" as="geometry" />
        </mxCell>

        <mxCell id="conn-start-0" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="start" target="step0">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="400" as="sourcePoint" />
            <mxPoint x="650" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Decision: Ingress or Port-Forward -->
        <mxCell id="decision-ingress" value="Install Ingress Controller?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="570" y="280" width="260" height="100" as="geometry" />
        </mxCell>

        <mxCell id="conn-0-decision" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="step0" target="decision-ingress">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="400" as="sourcePoint" />
            <mxPoint x="650" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Yes Path: Install Ingress -->
        <mxCell id="install-ingress" value="Phase 0: Install NGINX Ingress&#xa;&#xa;kubectl apply -f nginx-ingress.yaml&#xa;Wait for LoadBalancer ready&#xa;Update /etc/hosts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left" vertex="1" parent="1">
          <mxGeometry x="880" y="280" width="240" height="100" as="geometry" />
        </mxCell>

        <mxCell id="conn-yes-ingress" value="YES" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#009900" edge="1" parent="1" source="decision-ingress" target="install-ingress">
          <mxGeometry x="-0.2" width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="500" as="sourcePoint" />
            <mxPoint x="650" y="450" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- No Path: Skip Ingress -->
        <mxCell id="skip-ingress" value="Skip Ingress&#xa;(Will use port-forward)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=11;dashed=1" vertex="1" parent="1">
          <mxGeometry x="280" y="300" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="conn-no-ingress" value="NO" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#CC0000;dashed=1" edge="1" parent="1" source="decision-ingress" target="skip-ingress">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="500" as="sourcePoint" />
            <mxPoint x="650" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Merge point -->
        <mxCell id="merge1" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="690" y="410" width="20" height="20" as="geometry" />
        </mxCell>

        <mxCell id="conn-skip-merge" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="skip-ingress" target="merge1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="500" as="sourcePoint" />
            <mxPoint x="650" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="conn-ingress-merge" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="install-ingress" target="merge1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="500" as="sourcePoint" />
            <mxPoint x="650" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Phase 1: Namespaces -->
        <mxCell id="phase1" value="Phase 1: Create Namespaces&#xa;&#xa;kubectl apply -f namespace.yaml&#xa;&#xa;Created:&#xa;â€¢ jenkins&#xa;â€¢ argocd&#xa;â€¢ vault&#xa;â€¢ dev, sit, uat, prod" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="460" width="300" height="140" as="geometry" />
        </mxCell>

        <mxCell id="conn-merge-phase1" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="merge1" target="phase1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="600" as="sourcePoint" />
            <mxPoint x="650" y="550" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Phase 2: RBAC -->
        <mxCell id="phase2" value="Phase 2: Configure RBAC&#xa;&#xa;kubectl apply -f rbac/&#xa;&#xa;Created:&#xa;â€¢ ClusterRole: cluster-admin&#xa;â€¢ ClusterRole: developer&#xa;â€¢ ClusterRole: viewer&#xa;â€¢ RoleBindings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="630" width="300" height="140" as="geometry" />
        </mxCell>

        <mxCell id="conn-phase1-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="phase1" target="phase2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="700" as="sourcePoint" />
            <mxPoint x="650" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Phase 3: Jenkins -->
        <mxCell id="phase3" value="Phase 3: Deploy Jenkins&#xa;&#xa;helm install jenkins jenkins/jenkins \&#xa;  -f values-local.yaml -n jenkins&#xa;&#xa;Wait for pod ready&#xa;Get admin password" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b1ddf0;strokeColor=#10739e;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="800" width="300" height="120" as="geometry" />
        </mxCell>

        <mxCell id="conn-phase2-3" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="phase2" target="phase3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="800" as="sourcePoint" />
            <mxPoint x="650" y="750" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Phase 4: Argo CD -->
        <mxCell id="phase4" value="Phase 4: Deploy Argo CD&#xa;&#xa;kubectl apply -n argocd -f \&#xa;  argo-cd-install.yaml&#xa;&#xa;Wait for pods ready&#xa;Patch server for insecure mode&#xa;Apply Ingress (if enabled)&#xa;Get admin password" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fad9d5;strokeColor=#ae4132;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="950" width="300" height="150" as="geometry" />
        </mxCell>

        <mxCell id="conn-phase3-4" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="phase3" target="phase4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="900" as="sourcePoint" />
            <mxPoint x="650" y="850" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Phase 5: Vault -->
        <mxCell id="phase5" value="Phase 5: Deploy Vault&#xa;&#xa;helm install vault hashicorp/vault \&#xa;  -f values-local.yaml -n vault&#xa;&#xa;Wait for pod ready&#xa;Initialize Vault&#xa;Save unseal keys &amp; root token" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="1130" width="300" height="130" as="geometry" />
        </mxCell>

        <mxCell id="conn-phase4-5" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="phase4" target="phase5">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="1000" as="sourcePoint" />
            <mxPoint x="650" y="950" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Verification -->
        <mxCell id="verify" value="Verification&#xa;&#xa;â€¢ kubectl get pods -A&#xa;â€¢ kubectl get svc -A&#xa;â€¢ kubectl get ingress -A (if enabled)&#xa;â€¢ Test access to services" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;align=left;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="1290" width="300" height="120" as="geometry" />
        </mxCell>

        <mxCell id="conn-phase5-verify" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2" edge="1" parent="1" source="phase5" target="verify">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="1100" as="sourcePoint" />
            <mxPoint x="650" y="1050" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- End -->
        <mxCell id="end" value="âœ… COMPLETE&#xa;Platform Ready for Use!" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="1440" width="300" height="60" as="geometry" />
        </mxCell>

        <mxCell id="conn-verify-end" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#009900" edge="1" parent="1" source="verify" target="end">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="1200" as="sourcePoint" />
            <mxPoint x="650" y="1150" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Side notes -->
        <mxCell id="note1" value="ðŸ“ Note: Script Automation&#xa;&#xa;All these steps can be run&#xa;automatically using:&#xa;&#xa;bash scripts/deploy-local.sh&#xa;&#xa;Or manually step-by-step&#xa;using the documentation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;dashed=1" vertex="1" parent="1">
          <mxGeometry x="80" y="170" width="200" height="180" as="geometry" />
        </mxCell>

        <mxCell id="note2" value="âš™ï¸ Configuration Files&#xa;&#xa;Phase 1:&#xa;â€¢ namespace.yaml&#xa;&#xa;Phase 2:&#xa;â€¢ rbac/*.yaml&#xa;&#xa;Phase 3:&#xa;â€¢ jenkins/values-local.yaml&#xa;&#xa;Phase 4:&#xa;â€¢ argocd/install.yaml&#xa;â€¢ argocd/ingress.yaml&#xa;&#xa;Phase 5:&#xa;â€¢ vault/values-local.yaml" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;dashed=1;fontFamily=Courier New" vertex="1" parent="1">
          <mxGeometry x="80" y="630" width="200" height="290" as="geometry" />
        </mxCell>

        <mxCell id="note3" value="ðŸ” Credentials to Save&#xa;&#xa;Jenkins:&#xa;kubectl get secret -n jenkins \&#xa;  jenkins -o jsonpath=\&#xa;  '{.data.jenkins-admin-password}' \&#xa;  | base64 --decode&#xa;&#xa;Argo CD:&#xa;kubectl -n argocd get secret \&#xa;  argocd-initial-admin-secret \&#xa;  -o jsonpath='{.data.password}' \&#xa;  | base64 -d&#xa;&#xa;Vault:&#xa;kubectl exec -n vault vault-0 \&#xa;  -- vault operator init&#xa;(Save all unseal keys + root token!)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;align=left;dashed=1;fontFamily=Courier New" vertex="1" parent="1">
          <mxGeometry x="1160" y="630" width="280" height="350" as="geometry" />
        </mxCell>

        <mxCell id="note4" value="ðŸŒ Access Methods&#xa;&#xa;With Ingress:&#xa;â€¢ Jenkins: http://jenkins.local&#xa;â€¢ Argo CD: https://argocd.local&#xa;â€¢ Vault: http://vault.local&#xa;&#xa;With Port-Forward:&#xa;â€¢ kubectl port-forward -n jenkins \&#xa;    svc/jenkins 8080:8080&#xa;  â†’ http://localhost:8080&#xa;&#xa;â€¢ kubectl port-forward -n argocd \&#xa;    svc/argocd-server 8443:443&#xa;  â†’ https://localhost:8443&#xa;&#xa;â€¢ kubectl port-forward -n vault \&#xa;    svc/vault 8200:8200&#xa;  â†’ http://localhost:8200" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;align=left;dashed=1;fontFamily=Courier New" vertex="1" parent="1">
          <mxGeometry x="1160" y="1050" width="280" height="360" as="geometry" />
        </mxCell>

        <!-- Timeline -->
        <mxCell id="timeline" value="â±ï¸ Estimated Time&#xa;(Automated Script)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;verticalAlign=top;fontSize=12;fontStyle=1;align=left" vertex="1" parent="1">
          <mxGeometry x="80" y="1050" width="200" height="300" as="geometry" />
        </mxCell>

        <mxCell id="time1" value="Phase 0: 2-3 min" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1090" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time2" value="Phase 1: 10 sec" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1120" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time3" value="Phase 2: 10 sec" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1150" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time4" value="Phase 3: 3-5 min" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1180" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time5" value="Phase 4: 2-3 min" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1210" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time6" value="Phase 5: 1-2 min" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="1240" width="180" height="25" as="geometry" />
        </mxCell>

        <mxCell id="time-total" value="â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;Total: ~10-15 minutes" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="90" y="1280" width="180" height="40" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
